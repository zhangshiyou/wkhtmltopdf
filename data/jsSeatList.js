var JsBarcode = require('jsbarcode');
const { DOMImplementation, XMLSerializer } = require('xmldom');
const xmlSerializer = new XMLSerializer();
const document = new DOMImplementation().createDocument('http://www.w3.org/1999/xhtml', 'html', null);
const svgNode = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
// let list=[{"stuName":"蔡越","schoolName":"惊叹四中","ticketNo":"01SZ001","color":1},{"stuName":"曹阳","schoolName":"惊叹四中","ticketNo":"01SZ002","color":1},{"stuName":"曹紫怡","schoolName":"惊叹四中","ticketNo":"01SZ003","color":1},{"stuName":"陈可","schoolName":"惊叹四中","ticketNo":"01SZ004","color":1},{"stuName":"陈林","schoolName":"惊叹四中","ticketNo":"01SZ005","color":1},{"stuName":"陈轼","schoolName":"惊叹四中","ticketNo":"01SZ006","color":1},{"stuName":"陈钰","schoolName":"惊叹四中","ticketNo":"01SZ007","color":1},{"stuName":"陈悦","schoolName":"惊叹四中","ticketNo":"01SZ008","color":1},{"stuName":"程吉涛","schoolName":"惊叹四中","ticketNo":"01SZ009","color":1},{"stuName":"储梓诺","schoolName":"惊叹四中","ticketNo":"01SZ010","color":1},{"stuName":"戴丁良","schoolName":"惊叹四中","ticketNo":"01SZ011","color":1},{"stuName":"戴泽诚","schoolName":"惊叹四中","ticketNo":"01SZ012","color":1},{"stuName":"邓钦玲","schoolName":"惊叹四中","ticketNo":"01SZ013","color":1},{"stuName":"董博文","schoolName":"惊叹四中","ticketNo":"01SZ014","color":1},{"stuName":"段煜","schoolName":"惊叹四中","ticketNo":"01SZ015","color":1},{"stuName":"方迦明","schoolName":"惊叹四中","ticketNo":"01SZ016","color":1},{"stuName":"高飞","schoolName":"惊叹四中","ticketNo":"01SZ017","color":1},{"stuName":"高苏洁","schoolName":"惊叹四中","ticketNo":"01SZ018","color":1},{"stuName":"顾王倩","schoolName":"惊叹四中","ticketNo":"01SZ019","color":1},{"stuName":"韩雨池","schoolName":"惊叹四中","ticketNo":"01SZ020","color":2},{"stuName":"郝丁平","schoolName":"惊叹四中","ticketNo":"01SZ021","color":2},{"stuName":"何文静","schoolName":"惊叹四中","ticketNo":"01SZ022","color":2},{"stuName":"何烨","schoolName":"惊叹四中","ticketNo":"01SZ023","color":2},{"stuName":"贺煜","schoolName":"惊叹四中","ticketNo":"01SZ024","color":2},{"stuName":"胡彬","schoolName":"惊叹四中","ticketNo":"01SZ025","color":2},{"stuName":"花香","schoolName":"惊叹四中","ticketNo":"01SZ026","color":2},{"stuName":"黄宇","schoolName":"惊叹四中","ticketNo":"01SZ027","color":2},{"stuName":"贾乐","schoolName":"惊叹四中","ticketNo":"01SZ028","color":2},{"stuName":"江雨露","schoolName":"惊叹四中","ticketNo":"01SZ029","color":2},{"stuName":"蒋楠","schoolName":"惊叹四中","ticketNo":"01SZ030","color":2},{"stuName":"蒋童","schoolName":"惊叹四中","ticketNo":"01SZ031","color":2},{"stuName":"靳浩泽","schoolName":"惊叹四中","ticketNo":"01SZ032","color":2},{"stuName":"居颖","schoolName":"惊叹四中","ticketNo":"01SZ033","color":2},{"stuName":"孔艺","schoolName":"惊叹四中","ticketNo":"01SZ034","color":2},{"stuName":"赖杰晖","schoolName":"惊叹四中","ticketNo":"01SZ035","color":2},{"stuName":"李雯倩","schoolName":"惊叹四中","ticketNo":"01SZ036","color":2},{"stuName":"李雯晴","schoolName":"惊叹四中","ticketNo":"01SZ037","color":2},{"stuName":"李旭洋","schoolName":"惊叹四中","ticketNo":"01SZ038","color":2},{"stuName":"梁雪薇","schoolName":"惊叹四中","ticketNo":"01SZ039","color":2},{"stuName":"刘洁","schoolName":"惊叹四中","ticketNo":"01SZ040","color":3},{"stuName":"刘夏瑜","schoolName":"惊叹四中","ticketNo":"01SZ041","color":3},{"stuName":"刘易","schoolName":"惊叹四中","ticketNo":"01SZ042","color":3},{"stuName":"刘育秀","schoolName":"惊叹四中","ticketNo":"01SZ043","color":3},{"stuName":"柳尧喜","schoolName":"惊叹四中","ticketNo":"01SZ044","color":3},{"stuName":"卢佳","schoolName":"惊叹四中","ticketNo":"01SZ045","color":3},{"stuName":"陆友琼","schoolName":"惊叹四中","ticketNo":"01SZ046","color":3},{"stuName":"陆源","schoolName":"惊叹四中","ticketNo":"01SZ047","color":3},{"stuName":"路遥","schoolName":"惊叹四中","ticketNo":"01SZ048","color":3},{"stuName":"罗国秀","schoolName":"惊叹四中","ticketNo":"01SZ049","color":3},{"stuName":"罗莹","schoolName":"惊叹四中","ticketNo":"01SZ050","color":3},{"stuName":"毛钦珮","schoolName":"惊叹四中","ticketNo":"01SZ051","color":3},{"stuName":"毛蕊","schoolName":"惊叹四中","ticketNo":"01SZ052","color":3},{"stuName":"苗晶","schoolName":"惊叹四中","ticketNo":"01SZ053","color":3},{"stuName":"潘恒乐","schoolName":"惊叹四中","ticketNo":"01SZ054","color":3},{"stuName":"潘嘉艺","schoolName":"惊叹四中","ticketNo":"01SZ055","color":3},{"stuName":"潘磊","schoolName":"惊叹四中","ticketNo":"01SZ056","color":3},{"stuName":"钱之韵","schoolName":"惊叹四中","ticketNo":"01SZ057","color":3},{"stuName":"秦相印","schoolName":"惊叹四中","ticketNo":"01SZ058","color":3},{"stuName":"任琦","schoolName":"惊叹四中","ticketNo":"01SZ059","color":3},{"stuName":"舒春艳","schoolName":"惊叹四中","ticketNo":"01SZ060","color":3},{"stuName":"孙可怡","schoolName":"惊叹四中","ticketNo":"01SZ061","color":3},{"stuName":"孙丽萍","schoolName":"惊叹四中","ticketNo":"01SZ062","color":3},{"stuName":"汤巧慧","schoolName":"惊叹四中","ticketNo":"01SZ063","color":3},{"stuName":"汤润翰","schoolName":"惊叹四中","ticketNo":"01SZ064","color":4},{"stuName":"汤心怡","schoolName":"惊叹四中","ticketNo":"01SZ065","color":4},{"stuName":"唐文婕","schoolName":"惊叹四中","ticketNo":"01SZ066","color":4},{"stuName":"陶鑫","schoolName":"惊叹四中","ticketNo":"01SZ067","color":4},{"stuName":"王佳琪","schoolName":"惊叹四中","ticketNo":"01SZ068","color":4},{"stuName":"王娇娇","schoolName":"惊叹四中","ticketNo":"01SZ069","color":4},{"stuName":"王进","schoolName":"惊叹四中","ticketNo":"01SZ070","color":4},{"stuName":"王琦","schoolName":"惊叹四中","ticketNo":"01SZ071","color":4},{"stuName":"王钦","schoolName":"惊叹四中","ticketNo":"01SZ072","color":4},{"stuName":"王鑫","schoolName":"惊叹四中","ticketNo":"01SZ073","color":4},{"stuName":"王亦凡","schoolName":"惊叹四中","ticketNo":"01SZ074","color":4},{"stuName":"王智权","schoolName":"惊叹四中","ticketNo":"01SZ075","color":4},{"stuName":"王自丽","schoolName":"惊叹四中","ticketNo":"01SZ076","color":4},{"stuName":"吴琼","schoolName":"惊叹四中","ticketNo":"01SZ077","color":4},{"stuName":"吴冉","schoolName":"惊叹四中","ticketNo":"01SZ078","color":4},{"stuName":"吴艺","schoolName":"惊叹四中","ticketNo":"01SZ079","color":4},{"stuName":"吴云","schoolName":"惊叹四中","ticketNo":"01SZ080","color":4},{"stuName":"奚浩东","schoolName":"惊叹四中","ticketNo":"01SZ081","color":4},{"stuName":"夏莹莹","schoolName":"惊叹四中","ticketNo":"01SZ082","color":4},{"stuName":"徐佳俊","schoolName":"惊叹四中","ticketNo":"01SZ083","color":4},{"stuName":"徐嘉","schoolName":"惊叹四中","ticketNo":"01SZ084","color":4},{"stuName":"徐金花","schoolName":"惊叹四中","ticketNo":"01SZ085","color":4},{"stuName":"徐璋","schoolName":"惊叹四中","ticketNo":"01SZ086","color":1},{"stuName":"闫文静","schoolName":"惊叹四中","ticketNo":"01SZ087","color":1},{"stuName":"晏晓梅","schoolName":"惊叹四中","ticketNo":"01SZ088","color":1},{"stuName":"杨青松","schoolName":"惊叹四中","ticketNo":"01SZ089","color":1},{"stuName":"杨顺","schoolName":"惊叹四中","ticketNo":"01SZ090","color":1},{"stuName":"杨涛宁","schoolName":"惊叹四中","ticketNo":"01SZ091","color":1},{"stuName":"于晨轩","schoolName":"惊叹四中","ticketNo":"01SZ092","color":1},{"stuName":"袁慧玲","schoolName":"惊叹四中","ticketNo":"01SZ093","color":1},{"stuName":"翟天鹏","schoolName":"惊叹四中","ticketNo":"01SZ094","color":1},{"stuName":"张昕远","schoolName":"惊叹四中","ticketNo":"01SZ095","color":2},{"stuName":"张泽宇","schoolName":"惊叹四中","ticketNo":"01SZ096","color":2},{"stuName":"章雨彤","schoolName":"惊叹四中","ticketNo":"01SZ097","color":2},{"stuName":"赵岑兰","schoolName":"惊叹四中","ticketNo":"01SZ098","color":2},{"stuName":"赵晨慧","schoolName":"惊叹四中","ticketNo":"01SZ099","color":2},{"stuName":"赵颖","schoolName":"惊叹四中","ticketNo":"01SZ100","color":2},{"stuName":"郑小丽","schoolName":"惊叹四中","ticketNo":"01SZ101","color":3},{"stuName":"周诚","schoolName":"惊叹四中","ticketNo":"01SZ102","color":3},{"stuName":"周婧宇","schoolName":"惊叹四中","ticketNo":"01SZ103","color":3},{"stuName":"周梦园","schoolName":"惊叹四中","ticketNo":"01SZ104","color":3}]
let list=[{"stuName":"蔡越","schoolName":"惊叹四中","ticketNo":"01SZ001","color":1},{"stuName":"曹阳","schoolName":"惊叹四中","ticketNo":"01SZ002","color":1},{"stuName":"曹紫怡","schoolName":"惊叹四中","ticketNo":"01SZ003","color":1},{"stuName":"陈可","schoolName":"惊叹四中","ticketNo":"01SZ004","color":1},{"stuName":"陈林","schoolName":"惊叹四中","ticketNo":"01SZ005","color":1},{"stuName":"陈轼","schoolName":"惊叹四中","ticketNo":"01SZ006","color":1},{"stuName":"陈钰","schoolName":"惊叹四中","ticketNo":"01SZ007","color":1},{"stuName":"陈悦","schoolName":"惊叹四中","ticketNo":"01SZ008","color":1},{"stuName":"程吉涛","schoolName":"惊叹四中","ticketNo":"01SZ009","color":1},{"stuName":"储梓诺","schoolName":"惊叹四中","ticketNo":"01SZ010","color":1},{"stuName":"戴丁良","schoolName":"惊叹四中","ticketNo":"01SZ011","color":1},{"stuName":"戴泽诚","schoolName":"惊叹四中","ticketNo":"01SZ012","color":1},{"stuName":"邓钦玲","schoolName":"惊叹四中","ticketNo":"01SZ013","color":1},{"stuName":"董博文","schoolName":"惊叹四中","ticketNo":"01SZ014","color":1},{"stuName":"段煜","schoolName":"惊叹四中","ticketNo":"01SZ015","color":1},{"stuName":"方迦明","schoolName":"惊叹四中","ticketNo":"01SZ016","color":1},{"stuName":"高飞","schoolName":"惊叹四中","ticketNo":"01SZ017","color":1},{"stuName":"高苏洁","schoolName":"惊叹四中","ticketNo":"01SZ018","color":1},{"stuName":"顾王倩","schoolName":"惊叹四中","ticketNo":"01SZ019","color":1},{"stuName":"韩雨池","schoolName":"惊叹四中","ticketNo":"01SZ020","color":2},{"stuName":"郝丁平","schoolName":"惊叹四中","ticketNo":"01SZ021","color":2},{"stuName":"何文静","schoolName":"惊叹四中","ticketNo":"01SZ022","color":2},{"stuName":"何烨","schoolName":"惊叹四中","ticketNo":"01SZ023","color":2},{"stuName":"贺煜","schoolName":"惊叹四中","ticketNo":"01SZ024","color":2},{"stuName":"胡彬","schoolName":"惊叹四中","ticketNo":"01SZ025","color":2},{"stuName":"花香","schoolName":"惊叹四中","ticketNo":"01SZ026","color":2},{"stuName":"黄宇","schoolName":"惊叹四中","ticketNo":"01SZ027","color":2},{"stuName":"贾乐","schoolName":"惊叹四中","ticketNo":"01SZ028","color":2},{"stuName":"江雨露","schoolName":"惊叹四中","ticketNo":"01SZ029","color":2},{"stuName":"蒋楠","schoolName":"惊叹四中","ticketNo":"01SZ030","color":2},{"stuName":"蒋童","schoolName":"惊叹四中","ticketNo":"01SZ031","color":2},{"stuName":"靳浩泽","schoolName":"惊叹四中","ticketNo":"01SZ032","color":2},{"stuName":"居颖","schoolName":"惊叹四中","ticketNo":"01SZ033","color":2},{"stuName":"孔艺","schoolName":"惊叹四中","ticketNo":"01SZ034","color":2},{"stuName":"赖杰晖","schoolName":"惊叹四中","ticketNo":"01SZ035","color":2},{"stuName":"李雯倩","schoolName":"惊叹四中","ticketNo":"01SZ036","color":2},{"stuName":"李雯晴","schoolName":"惊叹四中","ticketNo":"01SZ037","color":2},{"stuName":"李旭洋","schoolName":"惊叹四中","ticketNo":"01SZ038","color":2},{"stuName":"梁雪薇","schoolName":"惊叹四中","ticketNo":"01SZ039","color":2},{"stuName":"刘洁","schoolName":"惊叹四中","ticketNo":"01SZ040","color":3},{"stuName":"刘夏瑜","schoolName":"惊叹四中","ticketNo":"01SZ041","color":3}]
list.forEach((item,index)=>{
    JsBarcode(svgNode, item.ticketNo, {
        xmlDocument: document,
        height: 55,
        format: "CODE128",
        text:`准考证号：${item.ticketNo}`
    });
    const svgText = xmlSerializer.serializeToString(svgNode);
    item['svgNode']=svgText
})
module.exports =list